<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ðŸ’° Personal Finance Tracker</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body {
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(135deg, #fbc2eb, #a6c1ee);
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    padding-top: 50px;
  }
  .card {
    border-radius: 20px;
    padding: 25px;
    width: 450px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.2);
    background: rgba(255,255,255,0.95);
    margin-bottom: 30px;
  }
  .transaction {
    display: flex;
    justify-content: space-between;
    padding: 10px;
    border-radius: 10px;
    margin-bottom: 5px;
    transition: transform 0.3s;
    cursor: pointer;
  }
  .transaction:hover { transform: scale(1.02); }
  .income { background: #28a745; color: #fff; }
  .expense { background: #dc3545; color: #fff; }
</style>
</head>
<body>

<div class="card text-center">
  <h2>ðŸ’° Personal Finance Tracker</h2>
  <h4 id="balance">Balance: $0</h4>

  <div class="row g-2 mt-3">
    <div class="col-6">
      <input type="text" id="desc" class="form-control" placeholder="Description">
    </div>
    <div class="col-3">
      <input type="number" id="amount" class="form-control" placeholder="Amount">
    </div>
    <div class="col-3">
      <select id="type" class="form-select">
        <option value="income">Income</option>
        <option value="expense">Expense</option>
      </select>
    </div>
  </div>

  <button class="btn btn-primary mt-2 w-100" onclick="addTransaction()">Add Transaction</button>

  <h5 class="mt-4">Transactions</h5>
  <div id="transactionList"></div>
</div>

<div class="card text-center">
  <h5>Expenses by Category</h5>
  <canvas id="expenseChart" height="250"></canvas>
</div>

<script>
let transactions = JSON.parse(localStorage.getItem('transactions')) || [];

function saveTransactions() {
  localStorage.setItem('transactions', JSON.stringify(transactions));
}

function updateUI() {
  const transactionList = document.getElementById('transactionList');
  transactionList.innerHTML = '';
  let balance = 0;
  let categories = {};

  transactions.forEach((t, index) => {
    const div = document.createElement('div');
    div.className = `transaction ${t.type}`;
    div.innerHTML = `<span>${t.desc}</span><span>$${t.amount}</span>`;
    div.onclick = () => { removeTransaction(index); };
    transactionList.appendChild(div);

    balance += t.type === 'income' ? t.amount : -t.amount;

    if(t.type === 'expense') {
      categories[t.desc] = (categories[t.desc] || 0) + t.amount;
    }
  });

  document.getElementById('balance').innerText = `Balance: $${balance}`;
  renderChart(categories);
}

function addTransaction() {
  const desc = document.getElementById('desc').value.trim();
  const amount = parseFloat(document.getElementById('amount').value);
  const type = document.getElementById('type').value;
  if(!desc || isNaN(amount)) return alert("Enter valid values!");

  if(type === 'income') {
    // Aggregate income by description
    const existingIncome = transactions.find(t => t.type === 'income' && t.desc.toLowerCase() === desc.toLowerCase());
    if(existingIncome) {
      existingIncome.amount += amount; // add to existing income
    } else {
      transactions.push({desc, amount, type});
    }
  } else {
    // Expense always separate
    transactions.push({desc, amount, type});
  }

  saveTransactions();
  updateUI();

  document.getElementById('desc').value = '';
  document.getElementById('amount').value = '';
}

function removeTransaction(index) {
  transactions.splice(index,1);
  saveTransactions();
  updateUI();
}

// Chart.js for expense breakdown
let chart;
function renderChart(categories){
  const ctx = document.getElementById('expenseChart').getContext('2d');
  const labels = Object.keys(categories);
  const data = Object.values(categories);

  if(chart) chart.destroy();

  chart = new Chart(ctx, {
    type: 'pie',
    data: {
      labels,
      datasets: [{
        label: 'Expenses',
        data,
        backgroundColor: ['#ff6384','#36a2eb','#ffcd56','#4bc0c0','#9966ff','#ff9f40','#ff7f50','#20b2aa'],
      }]
    },
    options: {
      responsive:true,
      plugins:{ legend:{ position:'bottom' } }
    }
  });
}

updateUI();
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
